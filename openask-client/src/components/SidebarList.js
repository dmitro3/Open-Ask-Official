import React, { useState, useEffect } from "react";
import { useLocation } from "react-router-dom";
import List from "@mui/material/List";
import ListItem from "@mui/material/ListItem";
import ListItemButton from "@mui/material/ListItemButton";
import ListItemIcon from "@mui/material/ListItemIcon";
import ListItemText from "@mui/material/ListItemText";
import Typography from "@mui/material/Typography";
import Stack from "@mui/material/Stack";
import Avatar from "@mui/material/Avatar";
import Divider from "@mui/material/Divider";
import { Button, Backdrop, Badge } from "@mui/material";
import { Box } from "@mui/material";
import PsychologyAltIcon from "@mui/icons-material/PsychologyAlt";
import TwitterIcon from "@mui/icons-material/Twitter";
import AskQuestion from "./AskQuestion";
import { WalletCard } from "./WalletCard";
import LensCard from "./LensCard";

import { useNavigate, useParams } from "react-router-dom";
import axios, * as others from "axios";

const SidebarList = ({
  userInfo,
  accessToken,
  setAccessError,
  setMobileOpen,
  mobileOpen,
}) => {
  const [open, setOpen] = useState(false);

  const [hidden, setHidden] = useState(false);

  const [selectedIndex, setSelectedIndex] = useState(null);
  const [waitingQuestionsCount, setWaitingQuestionsCount] = useState();

  const navigate = useNavigate();

  const location = useLocation();

  useEffect(() => {
    if (location.pathname === "/feed") {
      setSelectedIndex(0);
    } else if (location.pathname === "/sensei") {
      setSelectedIndex(1);
    } else if (location.pathname === "/questions") {
      setSelectedIndex(2);
    } else if (location.pathname === "/transaction_history") {
      setSelectedIndex(3);
    } else if (location.pathname === `/sensei/${userInfo.profile.handle}`) {
      setSelectedIndex(4);
    }
  }, [location]);

  const sidebarItems = [
    {
      text: "Home",
      link: "/feed",
      svg:
        selectedIndex === 0 ? (
          <svg
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M8.73134 21H5.41791C4.07463 21 3 19.9227 3 18.5761V10.1372C3 9.05985 3.53731 7.98254 4.52239 7.35411L10.7015 3.40399C11.5075 2.86534 12.4925 2.86534 13.2985 3.40399L19.4776 7.35411C20.3731 7.98254 21 8.97007 21 10.1372V18.5761C21 19.9227 19.9254 21 18.5821 21H15.3582H8.73134Z'
              fill='#2794F5'
            />
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M12.7429 4.23528C12.2732 3.92141 11.7268 3.92141 11.2571 4.23528L11.2401 4.24642L5.06101 8.19654C4.37822 8.63213 4 9.38381 4 10.137V18.5759C4 19.3726 4.62926 19.9999 5.41791 19.9999H18.5821C19.3707 19.9999 20 19.3726 20 18.5759V10.137C20 9.35807 19.5879 8.65971 18.9196 8.18412L12.7599 4.24642L12.7429 4.23528ZM13.845 2.56636C12.7073 1.81105 11.2927 1.81105 10.155 2.56635L3.98456 6.51094C3.98471 6.51084 3.98441 6.51103 3.98456 6.51094C2.69748 7.33225 2 8.73581 2 10.137V18.5759C2 20.4725 3.51999 21.9999 5.41791 21.9999H18.5821C20.48 21.9999 22 20.4725 22 18.5759V10.137C22 8.58818 21.1651 7.31649 20.052 6.53543C20.0403 6.52718 20.0283 6.51918 20.0162 6.51144L13.845 2.56636Z'
              fill='#2794F5'
            />
          </svg>
        ) : (
          <svg
            width='20'
            height='20'
            viewBox='0 0 20 20'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M10.7429 2.23528C10.2732 1.92141 9.72678 1.92141 9.25715 2.23528L9.24011 2.24642L3.06101 6.19654C2.37822 6.63213 2 7.38381 2 8.13704V16.5759C2 17.3726 2.62926 17.9999 3.41791 17.9999H16.5821C17.3707 17.9999 18 17.3726 18 16.5759V8.13704C18 7.35807 17.5879 6.65971 16.9196 6.18412L10.7599 2.24642L10.7429 2.23528ZM11.845 0.566364C10.7073 -0.188945 9.29271 -0.188951 8.15501 0.566347L1.98456 4.51094C1.98441 4.51103 1.98471 4.51084 1.98456 4.51094C0.69748 5.33225 0 6.73581 0 8.13704V16.5759C0 18.4725 1.51999 19.9999 3.41791 19.9999H16.5821C18.48 19.9999 20 18.4725 20 16.5759V8.13704C20 6.58818 19.1651 5.31649 18.052 4.53543C18.0403 4.52718 18.0283 4.51918 18.0162 4.51144L11.845 0.566364Z'
              fill='#111111'
            />
          </svg>
        ),
    },
    {
      text: "Sensei",
      link: "/sensei",
      svg:
        selectedIndex === 1 ? (
          <svg
            width='24'
            height='25'
            viewBox='0 0 24 25'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M18.178 10.8955C16.3697 10.8955 14.7624 11.9372 13.9588 13.3955H10.2419C9.33778 11.833 7.83093 10.8955 5.92225 10.8955C3.20992 10.8955 0.999878 13.083 0.999878 15.8955C0.999878 18.708 3.20992 20.8955 5.92225 20.8955C8.63458 20.8955 10.8446 18.6038 10.8446 15.8955C10.8446 15.7913 10.8446 15.583 10.8446 15.4788H13.1551C13.1551 15.583 13.1551 15.7913 13.1551 15.8955C13.1551 18.708 15.3652 20.8955 18.0775 20.8955C20.7898 20.8955 22.9999 18.6038 22.9999 15.8955C22.9999 13.1872 20.8903 10.8955 18.178 10.8955Z'
              fill='#2794F5'
            />
            <path
              d='M1.61688 10.802C1.72388 10.8958 1.93788 10.8958 2.04488 10.8958C2.47288 10.8958 2.90088 10.7083 3.00788 10.3333L4.07788 8.08325C4.50588 7.2395 5.36188 6.77075 6.32488 6.77075H7.92988C8.57188 6.77075 8.99988 6.39575 8.99988 5.83325C8.99988 5.27075 8.46488 4.89575 7.92988 4.89575H6.32488C4.50588 4.89575 2.79388 5.83325 2.15188 7.2395L1.08188 9.58325C0.867884 10.052 1.08188 10.6145 1.61688 10.802Z'
              fill='#2794F5'
            />
            <path
              d='M16.9433 6.80051H18.3585C19.2076 6.80051 19.9623 7.2767 20.2453 8.03861L21.1888 10.3243C21.3775 10.7053 21.6605 10.8958 22.0379 10.8958C22.1322 10.8958 22.3209 10.8958 22.4152 10.8005C22.887 10.61 23.17 10.0386 22.887 9.56242L21.9435 7.2767C21.4718 5.84813 19.9623 4.89575 18.3585 4.89575H16.9433C16.3773 4.89575 15.9999 5.2767 15.9999 5.84813C15.9999 6.41956 16.4716 6.80051 16.9433 6.80051Z'
              fill='#2794F5'
            />
          </svg>
        ) : (
          <svg
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M18.178 10.0001C16.3697 10.0001 14.7624 11.0418 13.9588 12.5001H10.2419C9.33778 10.9376 7.83093 10.0001 5.92225 10.0001C3.20992 10.0001 0.999878 12.1876 0.999878 15.0001C0.999878 17.8126 3.20992 20.0001 5.92225 20.0001C8.63458 20.0001 10.8446 17.7085 10.8446 15.0001C10.8446 14.896 10.8446 14.6876 10.8446 14.5835H13.1551C13.1551 14.6876 13.1551 14.896 13.1551 15.0001C13.1551 17.8126 15.3652 20.0001 18.0775 20.0001C20.7898 20.0001 22.9999 17.7085 22.9999 15.0001C22.9999 12.2918 20.8903 10.0001 18.178 10.0001ZM5.92225 17.9168C4.31495 17.9168 3.00901 16.5626 3.00901 15.0001C3.00901 13.4376 4.31495 12.0835 5.92225 12.0835C7.52956 12.0835 8.8355 13.4376 8.8355 15.0001C8.8355 16.5626 7.63002 17.9168 5.92225 17.9168ZM18.178 17.9168C16.5707 17.9168 15.2647 16.5626 15.2647 15.0001C15.2647 13.4376 16.5707 12.0835 18.178 12.0835C19.7853 12.0835 21.0912 13.3335 21.0912 15.0001C21.0912 16.6668 19.7853 17.9168 18.178 17.9168Z'
              fill='black'
            />
            <path
              d='M1.53976 9.90649C1.63338 10.0002 1.82063 10.0002 1.91426 10.0002C2.28876 10.0002 2.66326 9.81274 2.75688 9.43774L3.69313 7.18774C4.06763 6.34399 4.81663 5.87524 5.65926 5.87524H7.06363C7.62538 5.87524 7.99988 5.50024 7.99988 4.93774C7.99988 4.37524 7.53175 4.00024 7.06363 4.00024H5.65926C4.06763 4.00024 2.56963 4.93774 2.00788 6.34399L1.07163 8.68774C0.884383 9.15649 1.07163 9.71899 1.53976 9.90649Z'
              fill='black'
            />
            <path
              d='M16.9433 5.90501H18.3585C19.2076 5.90501 19.9623 6.3812 20.2453 7.1431L21.1888 9.42882C21.3775 9.80977 21.6605 10.0002 22.0379 10.0002C22.1322 10.0002 22.3209 10.0002 22.4152 9.90501C22.887 9.71453 23.17 9.1431 22.887 8.66691L21.9435 6.3812C21.4718 4.95263 19.9623 4.00024 18.3585 4.00024H16.9433C16.3773 4.00024 15.9999 4.3812 15.9999 4.95263C15.9999 5.52405 16.4716 5.90501 16.9433 5.90501Z'
              fill='black'
            />
          </svg>
        ),
    },
    {
      text: "Questions",
      link: "/questions",
      svg:
        selectedIndex === 2 ? (
          <svg
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M19.8503 7.38148C19.339 4.32537 16.7825 1.76218 13.6124 1.17067C11.2604 0.677754 8.80621 1.26926 6.96553 2.74802C5.0226 4.22678 4 6.39564 4 8.66307C4 10.7333 4.81808 12.6064 6.35197 14.0852C7.06779 14.7753 7.47683 15.564 7.68135 16.4512L7.88587 17.7328C8.19265 19.0144 9.3175 20.0002 10.7491 20.0002H13.2034C14.5327 20.0002 15.7599 19.0144 16.0666 17.7328L16.3734 16.4512C16.5779 15.564 16.987 14.7753 17.7028 14.0852C19.5435 12.3107 20.3616 9.84608 19.8503 7.38148Z'
              fill='#2794F5'
            />
            <path
              d='M14.8267 21H9.06667C8.42667 21 8 21.4 8 22C8 22.6 8.42667 23 9.06667 23H14.9333C15.5733 23 16 22.6 16 22C16 21.4 15.4667 21 14.8267 21Z'
              fill='#2794F5'
            />
          </svg>
        ) : (
          <svg
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M19.8503 7.38148C19.339 4.32537 16.7825 1.76218 13.6124 1.17067C11.2604 0.677754 8.80621 1.26926 6.96553 2.74802C5.0226 4.22678 4 6.39564 4 8.66307C4 10.7333 4.81808 12.6064 6.35197 14.0852C7.06779 14.7753 7.47683 15.564 7.68135 16.4512L7.88587 17.7328C8.19265 19.0144 9.3175 20.0002 10.7491 20.0002H13.2034C14.5327 20.0002 15.7599 19.0144 16.0666 17.7328L16.3734 16.4512C16.5779 15.564 16.987 14.7753 17.7028 14.0852C19.5435 12.3107 20.3616 9.84608 19.8503 7.38148ZM16.2712 12.705C15.2486 13.6909 14.635 14.8739 14.3282 16.0569L14.0215 17.3385C14.0215 17.7328 13.6124 18.0286 13.2034 18.0286H10.7491C10.3401 18.0286 10.0333 17.7328 9.93106 17.3385L9.62428 16.0569C9.41976 14.7753 8.70395 13.6909 7.68135 12.705C6.65875 11.6206 6.04519 10.2404 6.04519 8.66307C6.04519 6.98714 6.86327 5.31121 8.19265 4.22678C9.3175 3.43811 10.6469 2.94519 11.9763 2.94519C12.3853 2.94519 12.7943 2.94519 13.2034 3.04377C15.5553 3.53669 17.396 5.40979 17.8051 7.67723C18.2141 9.55033 17.6005 11.4234 16.2712 12.705Z'
              fill='black'
            />
            <path
              d='M14.8267 21.0001H9.06667C8.42667 21.0001 8 21.4001 8 22.0001C8 22.6001 8.42667 23.0001 9.06667 23.0001H14.9333C15.5733 23.0001 16 22.6001 16 22.0001C16 21.4001 15.4667 21.0001 14.8267 21.0001Z'
              fill='black'
            />
          </svg>
        ),
    },
    {
      text: "Transactions",
      link: "/transaction_history",
      svg:
        selectedIndex === 3 ? (
          <svg
            width='24'
            height='25'
            viewBox='0 0 24 25'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M22.9032 8.60873L20.742 2.32065C20.5455 1.62197 19.956 1.22273 19.2684 1.12292C18.5807 1.02311 17.893 1.32254 17.5 1.92141L16.9106 2.8197C15.437 2.02122 13.8652 1.62197 12.1951 1.62197C8.16724 1.62197 4.6306 4.11724 3.05876 7.91006C2.96052 8.20949 2.96051 8.60873 3.25524 8.90817C3.45172 9.2076 3.84468 9.40722 4.23764 9.40722H7.0866C7.77428 9.40722 8.26548 9.2076 8.5602 8.80835C9.34612 7.61062 10.7215 6.81214 12.1951 6.81214C12.7845 6.81214 13.374 6.91195 13.8652 7.11157L13.1775 8.20949C12.7845 8.80835 12.7845 9.50703 13.0792 10.1059C13.374 10.7048 14.0616 11.104 14.6511 11.104L21.1349 11.0042C21.4296 11.0042 21.7244 10.9044 21.9208 10.8046C22.805 10.5051 23.198 9.50703 22.9032 8.60873Z'
              fill='#2794F5'
            />
            <path
              d='M20.6949 13.8862H17.7045C16.9827 13.8862 16.4671 14.0842 16.1577 14.4802C15.2297 15.6684 13.7861 16.3614 12.2393 16.3614C11.6206 16.3614 11.0019 16.2624 10.4863 16.0644L11.2081 14.9753C11.6206 14.3812 11.6206 13.6882 11.3113 13.0941C11.0019 12.5 10.2801 12.104 9.66139 12.104L2.85569 12.203C2.54634 12.203 2.23699 12.302 2.03076 12.401C1.20583 12.7971 0.793359 13.7872 1.10271 14.6783L3.37128 20.9159C3.57751 21.609 4.19621 22.005 4.91803 22.104C5.02114 22.104 5.12426 22.104 5.22737 22.104C5.84607 22.104 6.46477 21.807 6.77412 21.3119L7.39282 20.4208C8.93957 21.2129 10.5894 21.609 12.3424 21.609C16.5702 21.609 20.2824 19.1337 21.9323 15.3713C22.0354 14.9753 22.0354 14.5793 21.8292 14.2822C21.4167 13.9852 21.1073 13.8862 20.6949 13.8862Z'
              fill='#2794F5'
            />
          </svg>
        ) : (
          <svg
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M22.8636 8.7342L20.8085 2.59847C20.5149 1.80676 19.8298 1.21298 18.9491 1.01505C18.0683 0.916085 17.2854 1.31194 16.6982 2.00468L16.3068 2.4995C14.9367 1.80676 13.3709 1.4109 11.8051 1.4109C7.30335 1.4109 3.19311 4.47877 2.01875 8.93213C1.92089 9.42695 2.21448 10.0207 2.70379 10.2187C3.19311 10.3176 3.78029 10.0207 3.87815 9.52591C4.85678 5.96323 8.08626 3.48914 11.8051 3.48914C13.273 3.48914 14.7409 3.88499 16.111 4.6767C16.5025 4.97359 17.0897 4.87463 17.3832 4.37981L18.264 3.19225C18.3619 2.99432 18.5576 2.99432 18.6555 2.99432C18.7533 2.99432 18.8512 3.09328 18.9491 3.19225L21.102 9.32798C21.1999 9.52591 21.102 9.72384 20.9063 9.8228H20.8085L14.2516 9.92177C14.0559 9.92177 13.958 9.8228 13.958 9.72384C13.958 9.62488 13.8602 9.52591 13.958 9.32798L14.9367 7.84353C15.1324 7.64561 15.1324 7.34871 15.1324 7.05182C15.0345 6.75493 14.9367 6.55701 14.6431 6.35908C13.7623 5.86426 12.7837 5.66633 11.8051 5.66633C9.65207 5.66633 7.69481 6.8539 6.61831 8.7342C6.42259 9.22902 6.52045 9.8228 7.00977 10.1197C7.49908 10.3176 8.08626 10.2187 8.37985 9.72384C9.06489 8.43731 10.435 7.64561 11.9029 7.64561C12.1965 7.64561 12.4901 7.64561 12.7837 7.74457L12.4901 8.23939C12.0008 8.93213 11.9029 9.92177 12.2944 10.7135C12.6858 11.5052 13.4687 12 14.3495 12L20.8085 11.901C21.1999 11.901 21.5914 11.8021 21.8849 11.6041C22.7657 11.0104 23.255 9.8228 22.8636 8.7342Z'
              fill='black'
            />
            <path
              d='M21.3849 13.7161C20.8887 13.5142 20.2931 13.9179 20.1939 14.4225C19.2013 17.9546 15.9259 20.4776 12.2535 20.4776C10.7647 20.4776 9.27591 20.0739 7.9856 19.2665C7.58858 18.9638 6.99306 19.0647 6.69529 19.5693L5.80201 20.7803C5.70275 20.8812 5.50424 20.8812 5.40499 20.8812C5.30574 20.8812 5.20648 20.7803 5.10723 20.6794L3.02289 14.5234C2.92363 14.3216 3.02289 14.1198 3.2214 14.0188H3.32065L9.77218 13.9179C9.97069 13.9179 10.0699 14.0188 10.0699 14.1198C10.0699 14.2207 10.1692 14.3216 10.0699 14.5234L9.0774 16.0372C8.87889 16.239 8.87889 16.5418 8.87889 16.8445C8.97814 17.1473 9.0774 17.3491 9.37516 17.5509C10.2684 18.0555 11.1617 18.2574 12.2535 18.2574C14.4371 18.2574 16.4222 17.0464 17.4148 15.2298C17.7125 14.7253 17.514 14.1198 17.0177 13.817C16.5215 13.5143 15.9259 13.7161 15.6282 14.2207C14.9334 15.5326 13.5438 16.239 12.1543 16.239C11.8565 16.239 11.5588 16.239 11.3602 16.1381L11.658 15.7344C12.1543 15.028 12.2535 14.0188 11.8565 13.3124C11.4595 12.5051 10.6655 12.0005 9.77218 12.0005L3.32065 12.1014C2.92363 12.1014 2.52661 12.2023 2.22885 12.4042C1.23631 12.9087 0.740038 14.2207 1.13705 15.3308L3.2214 21.4867C3.51916 22.2941 4.21394 22.8996 5.10723 23.0005C5.20648 23.0005 5.30574 23.0005 5.40499 23.0005C6.19902 23.0005 6.8938 22.5968 7.29082 21.9913L7.58858 21.4867C8.97814 22.1931 10.467 22.4959 12.055 22.4959C16.6207 22.4959 20.5909 19.3675 21.8812 14.9271C22.179 14.4225 21.8812 13.817 21.3849 13.7161Z'
              fill='black'
            />
          </svg>
        ),
    },
    {
      text: "Profile",
      link: "/sensei/RiceFarmerNFT",
      svg:
        selectedIndex === 4 ? (
          <svg
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M11.9999 2C6.49988 2 1.99988 6.5 1.99988 12C1.99988 14.6 2.99988 17.1 4.89988 19L4.99988 19.1C6.19988 20.2 7.59988 21.1 9.09988 21.6C10.0999 21.9 11.0999 22 12.0999 22C13.0999 22 14.0999 21.8 15.0999 21.6C16.5999 21.1 17.9999 20.3 19.1999 19.2L19.2999 19.1C21.0999 17.2 22.1999 14.7 22.1999 12.1C21.9999 6.5 17.4999 2 11.9999 2ZM11.9999 4C16.3999 4 19.9999 7.6 19.9999 12C19.9999 13.7 19.4999 15.3 18.4999 16.6C17.6999 15.3 16.4999 14.4 15.0999 13.8C15.7999 13 16.2999 12 16.2999 10.8C16.2999 8.4 14.3999 6.5 11.9999 6.5C9.59988 6.5 7.69988 8.4 7.69988 10.8C7.69988 12 8.19988 13 8.89988 13.8C7.49988 14.4 6.39988 15.4 5.49988 16.6C4.49988 15.3 3.99988 13.6 3.99988 12C3.99988 7.6 7.59988 4 11.9999 4Z'
              fill='#2794F5'
            />
          </svg>
        ) : (
          <svg
            width='24'
            height='25'
            viewBox='0 0 24 25'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              d='M11.9999 2.104C6.49988 2.104 1.99988 6.604 1.99988 12.104C1.99988 17.604 6.49988 22.104 11.9999 22.104C17.4999 22.104 21.9999 17.604 21.9999 12.104C21.9999 6.604 17.4999 2.104 11.9999 2.104ZM11.9999 20.104C7.59988 20.104 3.99988 16.504 3.99988 12.104C3.99988 7.704 7.59988 4.104 11.9999 4.104C16.3999 4.104 19.9999 7.704 19.9999 12.104C19.9999 16.504 16.3999 20.104 11.9999 20.104Z'
              fill='black'
            />
            <path
              d='M17.5 15.504C16.8 14.804 16 14.304 15.1 13.904C15.8 13.104 16.3 12.104 16.3 10.904C16.3 8.504 14.4 6.604 12 6.604C9.59995 6.604 7.69995 8.504 7.69995 10.904C7.69995 12.104 8.19995 13.104 8.89995 13.904C7.99995 14.304 7.19995 14.804 6.49995 15.504C6.09995 15.904 6.09995 16.504 6.49995 16.904C6.69995 17.104 6.99995 17.204 7.19995 17.204C7.49995 17.204 7.69995 17.104 7.89995 16.904C8.99995 15.804 10.4 15.204 12 15.204C13.5 15.204 15 15.804 16.1 16.904C16.5 17.304 17.1 17.304 17.5 16.904C17.9 16.504 17.9 15.904 17.5 15.504ZM9.69995 10.904C9.69995 9.604 10.7 8.604 12 8.604C13.3 8.604 14.3 9.604 14.3 10.904C14.3 12.204 13.3 13.204 12 13.204C10.7 13.204 9.69995 12.204 9.69995 10.904Z'
              fill='black'
            />
          </svg>
        ),
    },
  ];

  // Find waiting questions count
  useEffect(() => {
    const getQuestionsFor = async () => {
      if (userInfo) {
        try {
          const { data } = await axios.get(
            `https://us-central1-open-ask-dbbe2.cloudfunctions.net/api/questions-for/${userInfo.userUid}`
          );
          const waiting = data.filter((question) => {
            return !question.answerId;
          });
          // Set waiting questions count
          setWaitingQuestionsCount(waiting.length);
        } catch (error) {
          console.error(error);
        }
      } else {
        console.log("No ID");
      }
    };

    getQuestionsFor();
  }, [userInfo]);

  // Hide ask button
  useEffect(() => {
    if (window.location.pathname.startsWith("/sensei")) {
      setHidden(true);
    } else {
      setHidden(false);
    }
  }, [window.location.pathname]);

  // Navigate to page and highlight current page
  const onItemClick = (link, index) => {
    navigate(link);
    setSelectedIndex(index);
    if (mobileOpen) {
      setMobileOpen(false);
    }
  };
  // Click ask question
  const onAskQuestion = () => {
    setOpen(!open);
  };

  // Navigate to ask page
  const onBtnClick = () => {
    setSelectedIndex(null);
    navigate("/sensei/ask");
  };

  const onProfileClick = () => {
    navigate(`/sensei/${userInfo.profile.handle}`);
  };

  const onAvatarLogin = () => {
    setOpen(!open);
  };

  const handleCloseBackdrop = () => {
    setOpen(false);
  };

  return (
    <>
      <Box className='sidebar-list-container'>
        <Box className='sidebar-logo'>
          <svg
            width='130'
            height='52'
            viewBox='0 0 200 52'
            fill='none'
            xmlns='http://www.w3.org/2000/svg'>
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M26.1044 24.0501C26.1044 16.7349 20.2923 11.2735 13.0271 11.2735C5.81211 11.2735 0 16.7349 0 24.0501C0 31.3653 5.81211 36.7766 13.0271 36.7766C20.2923 36.7766 26.1044 31.3653 26.1044 24.0501ZM7.41545 24.0501C7.41545 20.0919 9.97077 17.3862 13.0271 17.3862C16.1336 17.3862 18.6889 20.0919 18.6889 24.0501C18.6889 27.9582 16.1336 30.6639 13.0271 30.6639C9.97077 30.6639 7.41545 27.9582 7.41545 24.0501Z'
              fill='#111111'
            />
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M42.3575 36.7766C49.6227 36.7766 54.4828 31.3653 54.4828 24.0501C54.4828 16.7349 49.1216 11.2735 41.8565 11.2735C39.702 11.2735 37.798 12.1253 36.7458 13.3779V11.6242H29.3304V52H36.7458V34.7223C37.8982 35.8747 40.8544 36.7766 42.3575 36.7766ZM41.3554 16.8852C44.4619 16.8852 47.0172 20.0919 47.0172 24.0501C47.0172 27.9582 44.4619 31.1649 41.3554 31.1649C39.4014 31.1649 37.6477 29.8121 36.5955 27.7578C36.0945 26.7056 35.7938 25.453 35.7938 24.0501C35.7938 22.6973 36.1446 21.2944 36.5955 20.2923C37.5976 18.2881 39.4515 16.8852 41.3554 16.8852Z'
              fill='#111111'
            />
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M69.9844 30.6639C67.5292 30.6639 64.5731 28.6096 64.5731 25.7036H82.2098V24.0501C82.2098 16.6347 77.3497 11.2735 69.5334 11.2735C61.7171 11.2735 56.9071 16.7349 56.9071 24.0501C56.9071 31.3653 61.8674 36.7766 69.9844 36.7766C75.6461 36.7766 78.7025 34.8727 80.7067 32.167L75.7464 27.6075C74.594 29.7119 72.3894 30.6639 69.9844 30.6639ZM69.5334 17.3862C72.3393 17.3862 74.0428 18.6388 74.4436 20.9937H64.7234C65.1743 18.8392 66.8278 17.3862 69.5334 17.3862Z'
              fill='#111111'
            />
            <path
              d='M96.8596 16.8351C99.7657 16.8351 100.768 18.4885 100.768 22.2463V36.3758H108.183V22.2463C108.183 14.6305 105.728 11.2735 98.7636 11.2735C96.6091 11.2735 94.0037 12.1253 92.0997 13.9791V11.6242H84.6843V36.3758H92.0997V22.2463C92.0997 18.4885 93.8534 16.8351 96.8596 16.8351Z'
              fill='#111111'
            />
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M112.211 15.7829L117.722 18.9395C118.825 17.737 119.877 17.3361 122.031 17.3361C124.136 17.3361 125.539 18.5386 125.539 20.3925H121.681C114.866 20.3925 110.658 23.8998 110.658 29.1107C110.658 33.7203 113.263 36.7265 120.027 36.7265C122.332 36.7265 124.386 35.8246 125.539 34.6221V36.3758H132.954V19.0898C132.954 15.2818 129.948 11.2234 122.532 11.2234C118.674 11.2234 114.967 12.6764 112.211 15.7829ZM118.073 29.261C117.772 27.357 119.225 26.0042 121.18 26.0042H125.539V28.2088C125.539 29.3111 124.436 31.1649 121.18 31.1649C119.476 31.1649 118.274 30.6138 118.073 29.261Z'
              fill='#111111'
            />
            <path
              d='M147.661 21.6711C145.412 21.0598 143.596 20.5662 143.596 19.4405C143.596 17.8372 145.199 17.5365 146.001 17.5365C147.554 17.5365 149.808 18.8894 151.111 20.5929L155.921 15.7829C153.065 12.8768 149.508 11.2735 146.001 11.2735C142.944 11.2735 136.831 13.2777 136.831 19.1399C136.831 24.0501 141.441 25.7036 145.399 26.9061C145.606 26.9652 145.907 27.0166 146.251 27.0755C147.655 27.316 149.79 27.6816 149.307 29.2109C149.057 29.9624 147.654 30.6639 146.001 30.5136C144.347 30.3633 142.343 29.0605 140.94 27.357L136.08 32.2171C138.886 35.023 142.443 36.7766 146.001 36.7766C151.612 36.7766 156.122 33.9207 156.122 28.81C156.122 23.9702 151.319 22.6651 147.661 21.6711Z'
              fill='#111111'
            />
            <path
              d='M167.615 26.2046L175.632 36.3758H184.951C182.812 33.7176 180.189 30.5005 177.638 27.3721C177.332 26.9968 177.027 26.6227 176.724 26.251C175.411 24.6404 174.136 23.0748 172.976 21.6451L184.951 11.6242L176.724 8.77801L166.763 17.8372V0H159.298V36.3758H166.763V26.9061C166.873 26.8142 166.99 26.7223 167.104 26.633'
              fill='#111111'
            />
            <path
              d='M167.615 26.2046C167.488 26.3315 167.301 26.4786 167.104 26.633Z'
              fill='#111111'
            />
            <circle cx='194.542' cy='31.6797' r='5' fill='#111111' />
            <rect
              x='111'
              y='44'
              width='88.5424'
              height='8'
              fill='url(#paint0_linear_5_107)'
            />
            <defs>
              <linearGradient
                id='paint0_linear_5_107'
                x1='112.466'
                y1='44.5957'
                x2='125.716'
                y2='79.7613'
                gradientUnits='userSpaceOnUse'>
                <stop stopColor='#62C6FF' />
                <stop offset='1' stopColor='#207CE8' />
                <stop offset='1' stopColor='#2271CE' />
              </linearGradient>
            </defs>
          </svg>
        </Box>

        <Divider variant='middle' />
        <Box sx={{ mt: "12px", mb: "12px" }}>
          {sidebarItems.map((item, index) => (
            // <ListItem className="sidebar-item" key={index} disablePadding>
            //   <ListItemButton
            //     selected={selectedIndex === index}
            //     onClick={() => onItemClick(item.link, index)}
            //   >
            //     <ListItemText className="sidebar-text" primary={item.text} />
            //     {item.text === "Questions Answered" &&
            //       waitingQuestionsCount > 0 && (
            //         <Badge badgeContent={waitingQuestionsCount} color="primary" />
            //       )}
            //   </ListItemButton>
            // </ListItem>
            <ul className='sidebar-list' key={index}>
              <li
                className={`sidebar-item ${
                  selectedIndex === index ? "sidebar-selected-item" : ""
                }`}
                onClick={() => onItemClick(item.link, index)}>
                {item.svg} {item.text}
              </li>
            </ul>
          ))}
        </Box>
        <Box className='ask-btn-container'>
          {!hidden && (
            <button className='ask-btn' onClick={onAskQuestion} size='large'>
              Ask Question
            </button>
          )}
          <WalletCard
            accessToken={accessToken}
            setAccessError={setAccessError}
          />
          <LensCard
            accessToken={accessToken}
            setAccessError={setAccessError}
          />
        </Box>
        <Divider variant='middle' />
        <Box className='sidebar-footer'>
          <Typography>Terms of Service, Privacy Policy</Typography>
          <Typography>
            <span>&#169;</span> 2023 Boba Labs
          </Typography>
        </Box>
      </Box>

      <Backdrop className='ask-question-backdrop' open={open}>
        <AskQuestion
          userInfo={userInfo}
          accessToken={accessToken}
          setAccessError={setAccessError}
          handleCloseBackdrop={handleCloseBackdrop}
        />
      </Backdrop>
    </>
  );
};

export default SidebarList;
